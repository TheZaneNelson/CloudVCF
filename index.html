<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VCF Contact Creator | Share Your Contact Easily</title>
    <meta name="description" content="Create and share your contact card instantly. Generate a VCF file with one click and share via link, WhatsApp, or Telegram.">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourdomain.com/">
    <meta property="og:title" content="VCF Contact Creator | Share Your Contact Easily">
    <meta property="og:description" content="Create and share your contact card instantly. Generate a VCF file with one click.">
    <meta property="og:image" content="https://yourdomain.com/images/social-preview.jpg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://yourdomain.com/">
    <meta property="twitter:title" content="VCF Contact Creator | Share Your Contact Easily">
    <meta property="twitter:description" content="Create and share your contact card instantly. Generate a VCF file with one click.">
    <meta property="twitter:image" content="https://yourdomain.com/images/social-preview.jpg">

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3a0ca3;
            --accent-color: #4cc9f0;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --success-color: #2ecc71;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --border-radius: 8px;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            line-height: 1.6;
            color: var(--dark-color);
            background-color: #f5f7fa;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px 0;
            text-align: center;
            box-shadow: var(--box-shadow);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            transform: rotate(30deg);
            z-index: 1;
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 700px;
            margin: 0 auto;
        }

        main {
            padding: 40px 0;
        }

        .card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
            margin-bottom: 30px;
            transition: var(--transition);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.8rem;
            position: relative;
            padding-bottom: 10px;
        }

        h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background-color: var(--accent-color);
            border-radius: 3px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark-color);
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 16px;
            font-family: 'Poppins', sans-serif;
            transition: var(--transition);
        }

        input:focus, select:focus, textarea:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }

        .input-group {
            display: flex;
            gap: 10px;
        }

        .input-group select {
            flex: 0 0 120px;
        }

        .input-group input {
            flex: 1;
        }

        .btn {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: var(--border-radius);
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            text-align: center;
            transition: var(--transition);
            text-decoration: none;
        }

        .btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
        }

        .btn-block {
            display: block;
            width: 100%;
        }

        .btn-success {
            background-color: var(--success-color);
        }

        .btn-warning {
            background-color: var(--warning-color);
        }

        .btn-danger {
            background-color: var(--danger-color);
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
        }

        .btn-outline:hover {
            background-color: var(--primary-color);
            color: white;
        }

        .result-section {
            display: none;
            margin-top: 30px;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }

        .link-display {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: var(--border-radius);
            word-break: break-all;
            margin: 15px 0;
            font-family: monospace;
            border: 1px dashed #ccc;
            position: relative;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: rgba(0, 0, 0, 0.1);
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 12px;
            transition: var(--transition);
        }

        .copy-btn:hover {
            background-color: rgba(0, 0, 0, 0.2);
        }

        .share-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .share-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 15px;
            border-radius: var(--border-radius);
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
        }

        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .whatsapp {
            background-color: #25D366;
        }

        .telegram {
            background-color: #0088cc;
        }

        .facebook {
            background-color: #1877F2;
        }

        .twitter {
            background-color: #1DA1F2;
        }

        .preview-section {
            margin-top: 30px;
        }

        .preview-item {
            display: flex;
            margin-bottom: 10px;
        }

        .preview-label {
            font-weight: 500;
            min-width: 100px;
            color: #666;
        }

        .emoji-picker {
            position: relative;
            margin-top: 10px;
        }

        .emoji-trigger {
            background-color: #f0f0f0;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .emoji-trigger:hover {
            background-color: #e0e0e0;
        }

        .emoji-container {
            position: absolute;
            bottom: 50px;
            left: 0;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 10px;
            width: 300px;
            max-height: 200px;
            overflow-y: auto;
            display: none;
            z-index: 100;
        }

        .emoji-container.show {
            display: block;
        }

        .emoji-item {
            display: inline-block;
            font-size: 24px;
            padding: 5px;
            cursor: pointer;
            transition: var(--transition);
        }

        .emoji-item:hover {
            transform: scale(1.2);
        }

        .stats-container {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .stat-card {
            flex: 1;
            min-width: 200px;
            background-color: white;
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: var(--box-shadow);
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }

        .progress-container {
            width: 100%;
            background-color: #e9ecef;
            border-radius: var(--border-radius);
            height: 20px;
            margin-top: 10px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            border-radius: var(--border-radius);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: 500;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .feature-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            text-align: center;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .feature-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .feature-desc {
            color: #666;
            font-size: 0.95rem;
        }

        footer {
            background-color: var(--dark-color);
            color: white;
            padding: 40px 0;
            text-align: center;
        }

        .footer-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .footer-link {
            color: #aaa;
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-link:hover {
            color: white;
        }

        .copyright {
            color: #777;
            font-size: 0.9rem;
            margin-top: 20px;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate-fade {
            animation: fadeIn 0.6s ease forwards;
        }

        .delay-1 { animation-delay: 0.2s; }
        .delay-2 { animation-delay: 0.4s; }
        .delay-3 { animation-delay: 0.6s; }

        /* Responsive */
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .input-group {
                flex-direction: column;
            }
            
            .input-group select {
                flex: 1;
                width: 100%;
            }
            
            .share-buttons {
                flex-direction: column;
            }
            
            .share-btn {
                justify-content: center;
            }
        }

        /* Loading overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            display: none;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: white;
            margin-top: 20px;
            font-size: 1.2rem;
        }

        /* Confetti effect */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: #f00;
            opacity: 0;
            z-index: 9998;
            animation: confetti 5s ease-in-out;
        }

        @keyframes confetti {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* Session management */
        .session-section {
            display: none;
            margin-top: 30px;
        }

        .session-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .contacts-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .contacts-table th, 
        .contacts-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .contacts-table th {
            background-color: #f8f9fa;
            font-weight: 600;
        }

        .contacts-table tr:hover {
            background-color: #f8f9fa;
        }

        .action-btn {
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
        }

        .edit-btn {
            background-color: var(--warning-color);
            color: white;
            border: none;
            margin-right: 5px;
        }

        .delete-btn {
            background-color: var(--danger-color);
            color: white;
            border: none;
        }

        .export-btn {
            background-color: var(--success-color);
            color: white;
            border: none;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 500px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 1.5rem;
            color: var(--primary-color);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-content">
            <h1 class="animate-fade">VCF Contact Creator</h1>
            <p class="subtitle animate-fade delay-1">Create and share your digital contact card with a single link</p>
        </div>
    </header>

    <main class="container">
        <div class="card animate-fade delay-2">
            <h2>Create Your Session</h2>
            <form id="sessionForm">
                <div class="form-group">
                    <label for="sessionName">Session Name</label>
                    <input type="text" id="sessionName" required placeholder="Family Reunion 2023">
                </div>
                
                <div class="form-group">
                    <label for="contactPrefix">Contact Name Prefix (Optional)</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="contactPrefix" placeholder="🔥 or *">
                        <button type="button" class="emoji-trigger" id="emojiTrigger">😊</button>
                    </div>
                    <div class="emoji-picker">
                        <div class="emoji-container" id="emojiContainer">
                            <!-- Emojis will be added here by JavaScript -->
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="btn btn-block">Create Session</button>
            </form>
            
            <div class="result-section" id="sessionResultSection">
                <h3>Your Session Link</h3>
                <p>Share this link with family and friends to collect their contact details:</p>
                
                <div class="link-display">
                    <span id="sessionLink"></span>
                    <button class="copy-btn" onclick="copySessionLink()">Copy</button>
                </div>
                
                <div class="share-buttons">
                    <a href="#" class="share-btn whatsapp" id="whatsappShare">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.557.709.327 1.284.437 1.729.437.388 0 .663-.057.831-.123.17-.066.294-.148.377-.246.083-.099.127-.208.132-.327.006-.119-.011-.249-.052-.39-.157-.537-.739-1.254-1.051-1.614-.294-.343-.509-.59-.625-.74-.114-.15-.23-.313-.342-.492-.113-.178-.024-.337.084-.45.109-.114.27-.142.448-.085.178.058.95.447 1.368.639.418.193.71.258.964.258.254 0 .473-.057.662-.172.19-.114.402-.29.64-.523.237-.232.517-.52.844-.86.325-.342.72-.762 1.183-1.26.463-.5.762-.82.9-.966.136-.146.238-.27.304-.372.066-.102.099-.198.099-.287 0-.059-.016-.131-.049-.223-.033-.089-.127-.207-.28-.352-.153-.146-.28-.254-.38-.323-.101-.07-.224-.155-.37-.257-.146-.102-.27-.19-.37-.264-.101-.074-.187-.15-.258-.227-.071-.078-.109-.156-.114-.234-.005-.078.01-.156.045-.232.035-.077.143-.193.324-.347.18-.153.347-.28.5-.38.153-.1.304-.19.453-.27.15-.08.293-.152.43-.218.136-.066.273-.127.41-.184.136-.057.28-.114.43-.171.15-.057.305-.107.465-.15.16-.043.33-.085.51-.123.18-.039.375-.068.585-.087.21-.02.434-.029.673-.029.238 0 .488.01.748.028.26.02.516.05.765.093.25.043.488.103.715.18.227.077.434.171.62.28.187.11.347.24.48.39.133.15.238.322.315.515.077.194.116.41.116.65 0 .178-.02.363-.058.555-.039.193-.087.383-.146.57-.059.188-.122.363-.19.526-.068.164-.136.31-.204.438-.068.129-.127.228-.178.3-.05.07-.085.107-.104.107-.025 0-.06-.024-.104-.074-.045-.05-.1-.118-.166-.207-.066-.089-.132-.185-.198-.29-.066-.104-.127-.207-.184-.31-.058-.102-.1-.193-.13-.271-.029-.079-.044-.126-.044-.143 0-.029.015-.066.044-.114.029-.048.073-.107.132-.178.059-.071.132-.156.22-.255.088-.1.19-.21.308-.332.117-.123.25-.255.397-.4.147-.146.31-.3.49-.465.18-.166.375-.34.586-.525.21-.185.437-.373.68-.566.242-.193.5-.385.77-.576.27-.19.555-.373.855-.547.3-.174.613-.333.94-.476.326-.143.665-.263 1.016-.357.35-.095.71-.156 1.076-.185.365-.03.736-.023 1.11.02.373.044.744.126 1.11.246.365.12.715.284 1.046.492.33.208.633.465.905.77.273.306.503.665.69 1.08.187.415.28.888.28 1.423 0 .297-.03.61-.088.94-.059.33-.148.66-.266.99-.119.33-.27.648-.454.95-.185.304-.4.58-.646.84-.247.26-.526.49-.837.69-.31.2-.655.363-1.033.49-.379.126-.79.212-1.234.255-.444.044-.92.038-1.43-.014-.508-.053-1.046-.16-1.61-.32-.565-.16-1.15-.38-1.756-.66-.606-.28-1.226-.62-1.86-1.02z" fill="white"/>
                        </svg>
                        WhatsApp
                    </a>
                    <a href="#" class="share-btn telegram" id="telegramShare">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.894 8.221l-1.97 9.28c-.145.658-.537.818-1.084.508l-3-2.21-1.446 1.394c-.14.18-.357.295-.6.295-.002 0-.003 0-.005 0l.213-3.054 5.56-5.022c.24-.213-.054-.334-.373-.121l-6.869 4.326-2.96-.924c-.64-.203-.658-.64.135-.954l11.566-4.458c.538-.196 1.006.128.832.941z" fill="white"/>
                        </svg>
                        Telegram
                    </a>
                </div>
            </div>
        </div>

        <div class="card session-section" id="sessionManagementSection">
            <h2>Manage Your Session</h2>
            <div class="session-controls">
                <button class="btn btn-success" id="exportVcfBtn">Export All as VCF</button>
                <button class="btn btn-danger" id="deleteSessionBtn">Delete Session</button>
            </div>
            
            <div class="form-group">
                <input type="text" id="searchContacts" placeholder="Search contacts...">
            </div>
            
            <table class="contacts-table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Phone</th>
                        <th>Email</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="contactsTableBody">
                    <!-- Contacts will be added here by JavaScript -->
                </tbody>
            </table>
        </div>

        <div class="card" id="contactFormSection" style="display: none;">
            <h2>Add Your Contact</h2>
            <form id="contactForm">
                <div class="form-group">
                    <label for="firstName">First Name</label>
                    <input type="text" id="firstName" required placeholder="John">
                </div>
                
                <div class="form-group">
                    <label for="lastName">Last Name</label>
                    <input type="text" id="lastName" placeholder="Doe">
                </div>
                
                <div class="form-group">
                    <label for="phone">Phone Number</label>
                    <div class="input-group">
                        <select id="countryCode" required>
                            <option value="">Code</option>
                            <option value="+234">+234 (NG)</option>
                            <option value="+233">+233 (GH)</option>
                            <option value="+254">+254 (KE)</option>
                            <option value="+27">+27 (ZA)</option>
                            <option value="+1">+1 (US)</option>
                            <option value="+44">+44 (UK)</option>
                            <!-- More country codes -->
                        </select>
                        <input type="tel" id="phone" required placeholder="8012345678">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="email">Email (Optional)</label>
                    <input type="email" id="email" placeholder="john@example.com">
                </div>
                
                <div class="form-group">
                    <label for="company">Company (Optional)</label>
                    <input type="text" id="company" placeholder="Company Name">
                </div>
                
                <div class="form-group">
                    <label for="title">Title (Optional)</label>
                    <input type="text" id="title" placeholder="Job Title">
                </div>
                
                <button type="submit" class="btn btn-block">Submit Contact</button>
            </form>
        </div>
    </main>

    <!-- Edit Contact Modal -->
    <div class="modal" id="editContactModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Edit Contact</h3>
                <button class="close-modal">&times;</button>
            </div>
            <form id="editContactForm">
                <input type="hidden" id="editContactId">
                <div class="form-group">
                    <label for="editFirstName">First Name</label>
                    <input type="text" id="editFirstName" required>
                </div>
                
                <div class="form-group">
                    <label for="editLastName">Last Name</label>
                    <input type="text" id="editLastName">
                </div>
                
                <div class="form-group">
                    <label for="editPhone">Phone Number</label>
                    <div class="input-group">
                        <select id="editCountryCode" required>
                            <option value="">Code</option>
                            <option value="+234">+234 (NG)</option>
                            <option value="+233">+233 (GH)</option>
                            <option value="+254">+254 (KE)</option>
                            <option value="+27">+27 (ZA)</option>
                            <option value="+1">+1 (US)</option>
                            <option value="+44">+44 (UK)</option>
                        </select>
                        <input type="tel" id="editPhone" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="editEmail">Email (Optional)</label>
                    <input type="email" id="editEmail">
                </div>
                
                <div class="form-group">
                    <label for="editCompany">Company (Optional)</label>
                    <input type="text" id="editCompany">
                </div>
                
                <div class="form-group">
                    <label for="editTitle">Title (Optional)</label>
                    <input type="text" id="editTitle">
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline close-modal">Cancel</button>
                    <button type="submit" class="btn">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
        <div class="loading-text">Processing...</div>
    </div>

    <footer>
        <div class="container footer-content">
            <div class="footer-links">
                <a href="#" class="footer-link">Privacy Policy</a>
                <a href="#" class="footer-link">Terms of Service</a>
                <a href="#" class="footer-link">Contact Us</a>
            </div>
            <p class="copyright">© 2023 VCF Contact Creator. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // Emoji list
        const emojis = ["😀", "😃", "😄", "😁", "😆", "😅", "😂", "🤣", "😊", "😇", "🙂", "🙃", "😉", "😌", "😍", "🥰", "😘", "😗", "😙", "😚", "😋", "😛", "😝", "😜", "🤪", "🤨", "🧐", "🤓", "😎", "🤩", "🥳", "😏", "😒", "😞", "😔", "😟", "😕", "🙁", "☹️", "😣", "😖", "😫", "😩", "🥺", "😢", "😭", "😤", "😠", "😡", "🤬", "🤯", "😳", "🥵", "🥶", "😱", "😨", "😰", "😥", "😓", "🤗", "🤔", "🤭", "🤫", "🤥", "😶", "😐", "😑", "😬", "🙄", "😯", "😦", "😧", "😮", "😲", "🥱", "😴", "🤤", "😪", "😵", "🤐", "🥴", "🤢", "🤮", "🤧", "😷", "🤒", "🤕", "🤑", "🤠", "😈", "👿", "👹", "👺", "🤡", "💩", "👻", "💀", "☠️", "👽", "👾", "🤖", "🎃", "😺", "😸", "😹", "😻", "😼", "😽", "🙀", "😿", "😾", "👋", "🤚", "🖐", "✋", "🖖", "👌", "🤏", "✌️", "🤞", "🤟", "🤘", "🤙", "👈", "👉", "👆", "🖕", "👇", "☝️", "👍", "👎", "✊", "👊", "🤛", "🤜", "👏", "🙌", "👐", "🤲", "🤝", "🙏", "✍️", "💅", "🤳", "💪", "🦾", "🦿", "🦵", "🦶", "👂", "🦻", "👃", "🧠", "🦷", "🦴", "👀", "👁", "👅", "👄", "👶", "🧒", "👦", "👧", "🧑", "👨", "👩", "🧔", "👱", "🧓", "👴", "👵", "🙍", "🙎", "🙅", "🙆", "💁", "🙋", "🧏", "🙇", "🤦", "🤷", "👮", "🕵️", "💂", "👷", "🤴", "👸", "👳", "👲", "🧕", "🤵", "👰", "🤰", "🤱", "👼", "🎅", "🤶", "🦸", "🦹", "🧙", "🧚", "🧛", "🧜", "🧝", "🧞", "🧟", "💆", "💇", "🚶", "🧍", "🧎", "🏃", "💃", "🕺", "🕴️", "👯", "🧖", "🧗", "🤺", "🏇", "⛷️", "🏂", "🏌️", "🏄", "🚣", "🏊", "⛹️", "🏋️", "🚴", "🚵", "🤸", "🤼", "🤽", "🤾", "🤹", "🧘", "🛀", "🛌", "👭", "👫", "👬", "💏", "💑", "👪", "🗣️", "👤", "👥", "🫂", "👣", "🧳", "🌂", "☂️", "🧵", "🧶", "👓", "🕶️", "🥽", "🥼", "🦺", "👔", "👕", "👖", "🧣", "🧤", "🧥", "🧦", "👗", "👘", "🥻", "🩱", "🩲", "🩳", "👙", "👚", "👛", "👜", "👝", "🎒", "👞", "👟", "🥾", "🥿", "👠", "👡", "🩰", "👢", "👑", "👒", "🎩", "🎓", "🧢", "⛑️", "📿", "💄", "💍", "💎", "🔇", "🔈", "🔉", "🔊", "📢", "📣", "📯", "🔔", "🔕", "🎼", "🎵", "🎶", "🎙️", "🎚️", "🎛️", "🎤", "🎧", "📻", "🎷", "🎸", "🎹", "🎺", "🎻", "🪕", "🥁", "🪘", "📱", "📲", "☎️", "📞", "📟", "📠", "🔋", "🔌", "💻", "🖥️", "🖨️", "⌨️", "🖱️", "🖲️", "💽", "💾", "💿", "📀", "🧮", "🎥", "🎞️", "📽️", "🎬", "📺", "📷", "📸", "📹", "📼", "🔍", "🔎", "🕯️", "💡", "🔦", "🏮", "🪔", "📔", "📕", "📖", "📗", "📘", "📙", "📚", "📓", "📒", "📃", "📜", "📄", "📰", "🗞️", "📑", "🔖", "🏷️", "💰", "🪙", "💴", "💵", "💶", "💷", "💸", "💳", "🧾", "💹", "✉️", "📧", "📨", "📩", "📤", "📥", "📦", "📫", "📪", "📬", "📭", "📮", "🗳️", "✏️", "✒️", "🖋️", "🖊️", "🖌️", "🖍️", "📝", "💼", "📁", "📂", "🗂️", "📅", "📆", "🗒️", "🗓️", "📇", "📈", "📉", "📊", "📋", "📌", "📍", "📎", "🖇️", "📏", "📐", "✂️", "🗃️", "🗄️", "🗑️", "🔒", "🔓", "🔏", "🔐", "🔑", "🗝️", "🔨", "🪓", "⛏️", "⚒️", "🛠️", "🗡️", "⚔️", "🔫", "🪃", "🏹", "🛡️", "🪚", "🔧", "🪛", "🔩", "⚙️", "🗜️", "⚖️", "🦯", "🔗", "⛓️", "🪝", "🧰", "🧲", "🪜", "⚗️", "🧪", "🧫", "🧬", "🔬", "🔭", "📡", "💉", "🩸", "💊", "🩹", "🩺", "🚪", "🛗", "🪞", "🪟", "🛏️", "🛋️", "🪑", "🚽", "🪠", "🚿", "🛁", "🪤", "🪒", "🧴", "🧷", "🧹", "🧺", "🧻", "🪣", "🧼", "🪥", "🧽", "🧯", "🛒", "🚬", "⚰️", "🪦", "⚱️", "🧿", "🪬", "🗿", "🪧", "🪪", "🏧", "🚮", "🚰", "♿", "🚹", "🚺", "🚻", "🚼", "🚾", "🛂", "🛃", "🛄", "🛅", "⚠️", "🚸", "⛔", "🚫", "🚳", "🚭", "🚯", "🚱", "🚷", "📵", "🔞", "☢️", "☣️", "⬆️", "↗️", "➡️", "↘️", "⬇️", "↙️", "⬅️", "↖️", "↕️", "↔️", "↩️", "↪️", "⤴️", "⤵️", "🔃", "🔄", "🔙", "🔚", "🔛", "🔜", "🔝", "🛐", "⚛️", "🕉️", "✡️", "☸️", "☯️", "✝️", "☦️", "☪️", "☮️", "🕎", "🔯", "♈", "♉", "♊", "♋", "♌", "♍", "♎", "♏", "♐", "♑", "♒", "♓", "⛎", "🔀", "🔁", "🔂", "▶️", "⏩", "⏭️", "⏯️", "◀️", "⏪", "⏮️", "🔼", "⏫", "🔽", "⏬", "⏸️", "⏹️", "⏺️", "⏏️", "🎦", "🔅", "🔆", "📶", "📳", "📴", "♀️", "♂️", "⚧️", "✖️", "➕", "➖", "➗", "♾️", "‼️", "⁉️", "❓", "❔", "❕", "❗", "〰️", "💱", "💲", "⚕️", "♻️", "⚜️", "🔱", "📛", "🔰", "⭕", "✅", "☑️", "✔️", "❌", "❎", "➰", "➿", "〽️", "✳️", "✴️", "❇️", "©️", "®️", "™️", "#️⃣", "*️⃣", "0️⃣", "1️⃣", "2️⃣", "3️⃣", "4️⃣", "5️⃣", "6️⃣", "7️⃣", "8️⃣", "9️⃣", "🔟", "🔠", "🔡", "🔢", "🔣", "🔤", "🅰️", "🅱️", "🆎", "🆑", "🆒", "🆓", "🆔", "🆕", "🆖", "🆗", "🆘", "🆙", "🆚", "🈁", "🈂️", "🈷️", "🈶", "🈯", "🉐", "🈹", "🈚", "🈲", "🉑", "🈸", "🈴", "🈳", "㊗️", "㊙️", "🈺", "🈵", "🔴", "🟠", "🟡", "🟢", "🔵", "🟣", "🟤", "⚫", "⚪", "🟥", "🟧", "🟨", "🟩", "🟦", "🟪", "🟫", "⬛", "⬜", "◼️", "◻️", "◾", "◽", "▪️", "▫️", "🔶", "🔷", "🔸", "🔹", "🔺", "🔻", "💠", "🔘", "🔳", "🔲", "🏁", "🚩", "🎌", "🏴", "🏳️", "🏳️‍🌈", "🏳️‍⚧️", "🏴‍☠️", "🇦🇨", "🇦🇩", "🇦🇪", "🇦🇫", "🇦🇬", "🇦🇮", "🇦🇱", "🇦🇲", "🇦🇴", "🇦🇶", "🇦🇷", "🇦🇸", "🇦🇹", "🇦🇺", "🇦🇼", "🇦🇽", "🇦🇿", "🇧🇦", "🇧🇧", "🇧🇩", "🇧🇪", "🇧🇫", "🇧🇬", "🇧🇭", "🇧🇮", "🇧🇯", "🇧🇱", "🇧🇲", "🇧🇳", "🇧🇴", "🇧🇶", "🇧🇷", "🇧🇸", "🇧🇹", "🇧🇻", "🇧🇼", "🇧🇾", "🇧🇿", "🇨🇦", "🇨🇨", "🇨🇩", "🇨🇫", "🇨🇬", "🇨🇭", "🇨🇮", "🇨🇰", "🇨🇱", "🇨🇲", "🇨🇳", "🇨🇴", "🇨🇵", "🇨🇷", "🇨🇺", "🇨🇻", "🇨🇼", "🇨🇽", "🇨🇾", "🇨🇿", "🇩🇪", "🇩🇬", "🇩🇯", "🇩🇰", "🇩🇲", "🇩🇴", "🇩🇿", "🇪🇦", "🇪🇨", "🇪🇪", "🇪🇬", "🇪🇭", "🇪🇷", "🇪🇸", "🇪🇹", "🇪🇺", "🇫🇮", "🇫🇯", "🇫🇰", "🇫🇲", "🇫🇴", "🇫🇷", "🇬🇦", "🇬🇧", "🇬🇩", "🇬🇪", "🇬🇫", "🇬🇬", "🇬🇭", "🇬🇮", "🇬🇱", "🇬🇲", "🇬🇳", "🇬🇵", "🇬🇶", "🇬🇷", "🇬🇸", "🇬🇹", "🇬🇺", "🇬🇼", "🇬🇾", "🇭🇰", "🇭🇲", "🇭🇳", "🇭🇷", "🇭🇹", "🇭🇺", "🇮🇨", "🇮🇩", "🇮🇪", "🇮🇱", "🇮🇲", "🇮🇳", "🇮🇴", "🇮🇶", "🇮🇷", "🇮🇸", "🇮🇹", "🇯🇪", "🇯🇲", "🇯🇴", "🇯🇵", "🇰🇪", "🇰🇬", "🇰🇭", "🇰🇮", "🇰🇲", "🇰🇳", "🇰🇵", "🇰🇷", "🇰🇼", "🇰🇾", "🇰🇿", "🇱🇦", "🇱🇧", "🇱🇨", "🇱🇮", "🇱🇰", "🇱🇷", "🇱🇸", "🇱🇹", "🇱🇺", "🇱🇻", "🇱🇾", "🇲🇦", "🇲🇨", "🇲🇩", "🇲🇪", "🇲🇫", "🇲🇬", "🇲🇭", "🇲🇰", "🇲🇱", "🇲🇲", "🇲🇳", "🇲🇴", "🇲🇵", "🇲🇶", "🇲🇷", "🇲🇸", "🇲🇹", "🇲🇺", "🇲🇻", "🇲🇼", "🇲🇽", "🇲🇾", "🇲🇿", "🇳🇦", "🇳🇨", "🇳🇪", "🇳🇫", "🇳🇬", "🇳🇮", "🇳🇱", "🇳🇴", "🇳🇵", "🇳🇷", "🇳🇺", "🇳🇿", "🇴🇲", "🇵🇦", "🇵🇪", "🇵🇫", "🇵🇬", "🇵🇭", "🇵🇰", "🇵🇱", "🇵🇲", "🇵🇳", "🇵🇷", "🇵🇸", "🇵🇹", "🇵🇼", "🇵🇾", "🇶🇦", "🇷🇪", "🇷🇴", "🇷🇸", "🇷🇺", "🇷🇼", "🇸🇦", "🇸🇧", "🇸🇨", "🇸🇩", "🇸🇪", "🇸🇬", "🇸🇭", "🇸🇮", "🇸🇯", "🇸🇰", "🇸🇱", "🇸🇲", "🇸🇳", "🇸🇴", "🇸🇷", "🇸🇸", "🇸🇹", "🇸🇻", "🇸🇽", "🇸🇾", "🇸🇿", "🇹🇦", "🇹🇨", "🇹🇩", "🇹🇯", "🇹🇰", "🇹🇱", "🇹🇲", "🇹🇳", "🇹🇴", "🇹🇷", "🇹🇹", "🇹🇻", "🇹🇼", "🇹🇿", "🇺🇦", "🇺🇬", "🇺🇲", "🇺🇳", "🇺🇸", "🇺🇾", "🇺🇿", "🇻🇦", "🇻🇨", "🇻🇪", "🇻🇬", "🇻🇮", "🇻🇳", "🇻🇺", "🇼🇫", "🇼🇸", "🇽🇰", "🇾🇪", "🇾🇹", "🇿🇦", "🇿🇲", "🇿🇼", "🏴󠁧󠁢󠁥󠁮󠁧󠁿", "🏴󠁧󠁢󠁳󠁣󠁴󠁿", "🏴󠁧󠁢󠁷󠁬󠁳󠁿"];

        // DOM Elements
        const sessionForm = document.getElementById('sessionForm');
        const sessionResultSection = document.getElementById('sessionResultSection');
        const sessionLink = document.getElementById('sessionLink');
        const sessionManagementSection = document.getElementById('sessionManagementSection');
        const contactFormSection = document.getElementById('contactFormSection');
        const contactsTableBody = document.getElementById('contactsTableBody');
        const exportVcfBtn = document.getElementById('exportVcfBtn');
        const deleteSessionBtn = document.getElementById('deleteSessionBtn');
        const searchContacts = document.getElementById('searchContacts');
        const editContactModal = document.getElementById('editContactModal');
        const editContactForm = document.getElementById('editContactForm');
        const loadingOverlay = document.getElementById('loadingOverlay');
        const emojiTrigger = document.getElementById('emojiTrigger');
        const emojiContainer = document.getElementById('emojiContainer');

        // Current session data
        let currentSession = null;
        let contacts = [];

        // Initialize the app
        function initApp() {
            // Check if there's a session in the URL
            const urlParams = new URLSearchParams(window.location.search);
            const sessionId = urlParams.get('session');
            
            if (sessionId) {
                // Load the session
                loadSession(sessionId);
            } else {
                // Check if we're managing a session
                const savedSession = localStorage.getItem('currentSession');
                if (savedSession) {
                    currentSession = JSON.parse(savedSession);
                    contacts = JSON.parse(localStorage.getItem(`contacts_${currentSession.id}`)) || [];
                    showSessionManagement();
                }
            }
            
            // Populate emoji picker
            populateEmojiPicker();
            
            // Set up event listeners
            setupEventListeners();
        }

        // Set up event listeners
        function setupEventListeners() {
            // Session form submission
            // sessionForm.addEventListener('submit', function(e) {
            //     e.preventDefault();
            //     createSession();
            // });

            sessionForm.addEventListener('submit', createSession);
            
            // Emoji picker
            emojiTrigger.addEventListener('click', function() {
                emojiContainer.classList.toggle('show');
            });
            
            // Close emoji picker when clicking outside
            document.addEventListener('click', function(e) {
                if (!emojiTrigger.contains(e.target) && !emojiContainer.contains(e.target)) {
                    emojiContainer.classList.remove('show');
                }
            });
            
            // Export VCF button
            exportVcfBtn.addEventListener('click', exportAllContactsAsVcf);
            
            // Delete session button
            deleteSessionBtn.addEventListener('click', deleteSession);
            
            // Search contacts
            searchContacts.addEventListener('input', function() {
                filterContacts(this.value);
            });
            
            // Close modal buttons
            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', function() {
                    editContactModal.style.display = 'none';
                });
            });
            
            // Close modal when clicking outside
            editContactModal.addEventListener('click', function(e) {
                if (e.target === editContactModal) {
                    editContactModal.style.display = 'none';
                }
            });
            
            // Edit contact form submission
            editContactForm.addEventListener('submit', function(e) {
                e.preventDefault();
                saveEditedContact();
            });
            
            // Contact form submission
            document.getElementById('contactForm').addEventListener('submit', function(e) {
                e.preventDefault();
                submitContact();
            });
            
            // WhatsApp share button
            document.getElementById('whatsappShare').addEventListener('click', function(e) {
                e.preventDefault();
                shareViaWhatsApp();
            });
            
            // Telegram share button
            document.getElementById('telegramShare').addEventListener('click', function(e) {
                e.preventDefault();
                shareViaTelegram();
            });
        }

        // Populate emoji picker
        function populateEmojiPicker() {
            emojis.forEach(emoji => {
                const emojiElement = document.createElement('span');
                emojiElement.classList.add('emoji-item');
                emojiElement.textContent = emoji;
                emojiElement.addEventListener('click', function() {
                    document.getElementById('contactPrefix').value = emoji;
                    emojiContainer.classList.remove('show');
                });
                emojiContainer.appendChild(emojiElement);
            });
        }

        // Create a new session
        function createSession(e) {
            e.preventDefault(); // This prevents the page from reloading
            
            showLoading();
            
            const sessionName = document.getElementById('sessionName').value;
            const contactPrefix = document.getElementById('contactPrefix').value;
            
            // Generate a unique session ID
            const sessionId = generateId();
            
            currentSession = {
                id: sessionId,
                name: sessionName,
                prefix: contactPrefix,
                createdAt: new Date().toISOString()
            };
            
            // Save to localStorage
            localStorage.setItem('currentSession', JSON.stringify(currentSession));
            localStorage.setItem(`contacts_${sessionId}`, JSON.stringify([]));
            
            // Generate the session link
            const link = `${window.location.origin}${window.location.pathname}?session=${sessionId}`;
            sessionLink.textContent = link;
            
            // Show the result section
            sessionResultSection.style.display = 'block';
            
            // Scroll to the result section
            sessionResultSection.scrollIntoView({ behavior: 'smooth' });
            
            hideLoading();
        }

        // Load a session
        function loadSession(sessionId) {
            showLoading();
            
            // Check if this is our session (in localStorage)
            const savedSession = localStorage.getItem('currentSession');
            
            if (savedSession && JSON.parse(savedSession).id === sessionId) {
                // This is our session - show management interface
                currentSession = JSON.parse(savedSession);
                contacts = JSON.parse(localStorage.getItem(`contacts_${sessionId}`)) || [];
                showSessionManagement();
            } else {
                // This is someone else's session - show contact form
                currentSession = { id: sessionId };
                showContactForm();
            }
            
            hideLoading();
        }

        // Show session management interface
        function showSessionManagement() {
            sessionForm.style.display = 'none';
            sessionResultSection.style.display = 'none';
            contactFormSection.style.display = 'none';
            sessionManagementSection.style.display = 'block';
            
            // Populate contacts table
            renderContactsTable();
        }

        // Show contact form
        function showContactForm() {
            sessionForm.style.display = 'none';
            sessionResultSection.style.display = 'none';
            sessionManagementSection.style.display = 'none';
            contactFormSection.style.display = 'block';
        }

        // Render contacts table
        function renderContactsTable() {
            contactsTableBody.innerHTML = '';
            
            if (contacts.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="4" style="text-align: center;">No contacts yet</td>`;
                contactsTableBody.appendChild(row);
                return;
            }
            
            contacts.forEach((contact, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${contact.firstName} ${contact.lastName}</td>
                    <td>${contact.countryCode} ${contact.phone}</td>
                    <td>${contact.email || '-'}</td>
                    <td>
                        <button class="action-btn edit-btn" data-index="${index}">Edit</button>
                        <button class="action-btn delete-btn" data-index="${index}">Delete</button>
                    </td>
                `;
                contactsTableBody.appendChild(row);
            });
            
            // Add event listeners to edit and delete buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    editContact(index);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    deleteContact(index);
                });
            });
        }

        // Filter contacts
        function filterContacts(query) {
            if (!query) {
                renderContactsTable();
                return;
            }
            
            const filtered = contacts.filter(contact => {
                const name = `${contact.firstName} ${contact.lastName}`.toLowerCase();
                const phone = `${contact.countryCode} ${contact.phone}`.toLowerCase();
                const email = contact.email ? contact.email.toLowerCase() : '';
                
                return name.includes(query.toLowerCase()) || 
                       phone.includes(query.toLowerCase()) || 
                       email.includes(query.toLowerCase());
            });
            
            // Render filtered contacts
            contactsTableBody.innerHTML = '';
            
            if (filtered.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="4" style="text-align: center;">No matching contacts</td>`;
                contactsTableBody.appendChild(row);
                return;
            }
            
            filtered.forEach((contact, index) => {
                const originalIndex = contacts.findIndex(c => 
                    c.firstName === contact.firstName && 
                    c.lastName === contact.lastName && 
                    c.phone === contact.phone
                );
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${contact.firstName} ${contact.lastName}</td>
                    <td>${contact.countryCode} ${contact.phone}</td>
                    <td>${contact.email || '-'}</td>
                    <td>
                        <button class="action-btn edit-btn" data-index="${originalIndex}">Edit</button>
                        <button class="action-btn delete-btn" data-index="${originalIndex}">Delete</button>
                    </td>
                `;
                contactsTableBody.appendChild(row);
            });
            
            // Add event listeners to edit and delete buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    editContact(index);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    deleteContact(index);
                });
            });
        }

        // Edit a contact
        function editContact(index) {
            const contact = contacts[index];
            
            document.getElementById('editContactId').value = index;
            document.getElementById('editFirstName').value = contact.firstName;
            document.getElementById('editLastName').value = contact.lastName || '';
            document.getElementById('editCountryCode').value = contact.countryCode;
            document.getElementById('editPhone').value = contact.phone;
            document.getElementById('editEmail').value = contact.email || '';
            document.getElementById('editCompany').value = contact.company || '';
            document.getElementById('editTitle').value = contact.title || '';
            
            editContactModal.style.display = 'flex';
        }

        // Save edited contact
        function saveEditedContact() {
            const index = parseInt(document.getElementById('editContactId').value);
            const contact = contacts[index];
            
            contact.firstName = document.getElementById('editFirstName').value;
            contact.lastName = document.getElementById('editLastName').value;
            contact.countryCode = document.getElementById('editCountryCode').value;
            contact.phone = document.getElementById('editPhone').value;
            contact.email = document.getElementById('editEmail').value;
            contact.company = document.getElementById('editCompany').value;
            contact.title = document.getElementById('editTitle').value;
            
            // Save to localStorage
            localStorage.setItem(`contacts_${currentSession.id}`, JSON.stringify(contacts));
            
            // Update the table
            renderContactsTable();
            
            // Close the modal
            editContactModal.style.display = 'none';
        }

        // Delete a contact
        function deleteContact(index) {
            if (confirm('Are you sure you want to delete this contact?')) {
                contacts.splice(index, 1);
                
                // Save to localStorage
                localStorage.setItem(`contacts_${currentSession.id}`, JSON.stringify(contacts));
                
                // Update the table
                renderContactsTable();
            }
        }

        // Submit a contact
        function submitContact() {
            showLoading();
            
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            const countryCode = document.getElementById('countryCode').value;
            const phone = document.getElementById('phone').value;
            const email = document.getElementById('email').value;
            const company = document.getElementById('company').value;
            const title = document.getElementById('title').value;
            
            const contact = {
                firstName,
                lastName,
                countryCode,
                phone,
                email,
                company,
                title,
                submittedAt: new Date().toISOString()
            };
            
            // Add to contacts array
            contacts = JSON.parse(localStorage.getItem(`contacts_${currentSession.id}`)) || [];
            contacts.push(contact);
            
            // Save to localStorage
            localStorage.setItem(`contacts_${currentSession.id}`, JSON.stringify(contacts));
            
            // Clear the form
            document.getElementById('contactForm').reset();
            
            // Show success message
            alert('Thank you! Your contact information has been submitted.');
            
            hideLoading();
        }

        // Export all contacts as VCF
        function exportAllContactsAsVcf() {
            showLoading();
            
            let vcfContent = '';
            
            contacts.forEach(contact => {
                vcfContent += generateVcf(contact);
            });
            
            // Create a blob and download it
            const blob = new Blob([vcfContent], { type: 'text/vcard' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `${currentSession.name || 'contacts'}.vcf`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            hideLoading();
        }

        // Generate VCF for a single contact
        function generateVcf(contact) {
            let vcf = 'BEGIN:VCARD\n';
            vcf += 'VERSION:3.0\n';
            
            // Name
            vcf += `FN:${contact.firstName} ${contact.lastName || ''}\n`;
            vcf += `N:${contact.lastName || ''};${contact.firstName};;;\n`;
            
            // Phone
            vcf += `TEL;TYPE=CELL:${contact.countryCode}${contact.phone}\n`;
            
            // Email
            if (contact.email) {
                vcf += `EMAIL:${contact.email}\n`;
            }
            
            // Organization
            if (contact.company || contact.title) {
                vcf += `ORG:${contact.company || ''}\n`;
                if (contact.title) {
                    vcf += `TITLE:${contact.title}\n`;
                }
            }
            
            vcf += 'END:VCARD\n';
            
            return vcf;
        }

        // Delete the current session
        function deleteSession() {
            if (confirm('Are you sure you want to delete this session and all its contacts?')) {
                localStorage.removeItem('currentSession');
                localStorage.removeItem(`contacts_${currentSession.id}`);
                
                currentSession = null;
                contacts = [];
                
                // Reload the page
                window.location.href = window.location.origin + window.location.pathname;
            }
        }

        // Copy session link to clipboard
        function copySessionLink() {
            const link = sessionLink.textContent;
            navigator.clipboard.writeText(link).then(() => {
                alert('Link copied to clipboard!');
            });
        }

        // Share via WhatsApp
        function shareViaWhatsApp() {
            const link = sessionLink.textContent;
            const text = `Please add your contact details to my session: ${link}`;
            window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
        }

        // Share via Telegram
        function shareViaTelegram() {
            const link = sessionLink.textContent;
            const text = `Please add your contact details to my session: ${link}`;
            window.open(`https://t.me/share/url?url=${encodeURIComponent(link)}&text=${encodeURIComponent(text)}`, '_blank');
        }

        // Generate a random ID
        function generateId() {
            return Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
        }

        // Show loading overlay
        function showLoading() {
            loadingOverlay.style.display = 'flex';
        }

        // Hide loading overlay
        function hideLoading() {
            loadingOverlay.style.display = 'none';
        }

        // Initialize the app when the DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>