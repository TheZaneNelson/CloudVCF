<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VCF Contact Creator | Share Your Contact Easily</title>
    <meta name="description" content="Create and share your contact card instantly. Generate a VCF file with one click and share via WhatsApp link.">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://cloud-vcf.vercel.app/">
    <meta property="og:title" content="VCF Contact Creator | Share Your Contact Easily">
    <meta property="og:description" content="Create and share your contact card instantly. Generate a VCF file with one click.">
    <meta property="og:image" content="https://cloud-vcf.vercel.app/images/social-preview.jpg">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://cloud-vcf.vercel.app/">
    <meta property="twitter:title" content="VCF Contact Creator | Share Your Contact Easily">
    <meta property="twitter:description" content="Create and share your contact card instantly. Generate a VCF file with one click.">
    <meta property="twitter:image" content="https://cloud-vcf.vercel.app/images/social-preview.jpg">

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #4361ee;
            --primary-light: #4895ef;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --danger: #f72585;
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --card-bg: rgba(26, 26, 46, 0.9);
            --input-bg: rgba(255, 255, 255, 0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: var(--light);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            background: var(--card-bg);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 2.5rem;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(67, 97, 238, 0.1) 0%, transparent 70%);
            z-index: -1;
            animation: rotate 15s linear infinite;
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        h1 {
            color: var(--success);
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .session-info {
            margin-bottom: 2rem;
        }
        
        .countdown {
            font-size: 1.2rem;
            font-weight: 500;
            color: var(--primary-light);
            margin-bottom: 1.5rem;
            display: inline-block;
            padding: 0.5rem 1rem;
            background: rgba(67, 97, 238, 0.2);
            border-radius: 50px;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
            text-align: left;
        }
        
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.8);
        }
        
        input, select {
            width: 100%;
            padding: 0.8rem 1rem;
            border-radius: 8px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            background: var(--input-bg);
            color: var(--light);
            font-size: 1rem;
            transition: var(--transition);
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.3);
        }
        
        input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        button {
            width: 100%;
            padding: 1rem;
            border-radius: 8px;
            border: none;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 0.5rem;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(67, 97, 238, 0.4);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .loader {
            display: none;
            margin: 1.5rem auto;
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top-color: var(--success);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .message {
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            font-weight: 500;
            display: none;
        }
        
        .success {
            background: rgba(76, 201, 240, 0.2);
            color: var(--success);
            border: 1px solid var(--success);
            animation: fadeInOut 3s ease-in-out;
        }
        
        .error {
            background: rgba(247, 37, 133, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes fadeInOut {
            0%, 100% { opacity: 0; }
            20%, 80% { opacity: 1; }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        .download-section {
            display: none;
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .download-section p {
            margin-bottom: 1rem;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .btn {
            display: inline-block;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            text-decoration: none;
            transition: var(--transition);
            margin: 0.5rem;
        }
        
        .btn-download {
            background: linear-gradient(135deg, #4cc9f0, #4895ef);
            color: white;
        }
        
        .btn-download:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 201, 240, 0.4);
        }
        
        .btn-whatsapp {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
            margin-top: 1rem;
        }
        
        .btn-whatsapp:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(37, 211, 102, 0.4);
        }
        
        .powered-by {
            margin-top: 2rem;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.6);
        }
        
        .session-link {
            background: var(--input-bg);
            padding: 1rem;
            border-radius: 8px;
            margin: 1.5rem 0;
            word-break: break-all;
            position: relative;
        }
        
        .copy-btn {
            position: absolute;
            top: 50px;
            right: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: var(--light);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: var(--transition);
        }
        
        .copy-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .input-group {
            display: flex;
            gap: 10px;
        }
        
        .input-group select {
            flex: 0 0 100px;
        }
        
        .input-group input {
            flex: 1;
        }
        
        .member-count {
            margin-top: 1.5rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        /* Responsive adjustments */
        @media (max-width: 576px) {
            .container {
                padding: 1.5rem;
            }
            
            h1 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Initial View -->
        <div id="initialView">
            <h1>VCF Contact Creator</h1>
            <p class="session-info">Create and share your digital contact list with a single link</p>
            <button id="startBtn" class="btn">Create New Session</button>
        </div>
        
        <!-- Session Creation Form -->
        <div id="sessionSetup" style="display: none;">
            <h1>Create New Session</h1>
            <form id="sessionForm">
                <div class="form-group">
                    <label for="sessionName">Session Name</label>
                    <input type="text" id="sessionName" required placeholder="Family Reunion 2023">
                </div>
                
                <div class="form-group">
                    <label for="contactPrefix">Contact Name Prefix (Optional)</label>
                    <input type="text" id="contactPrefix" placeholder="ðŸ”¥ or *">
                </div>
                
                <div class="form-group">
                    <label for="whatsappLink">WhatsApp Group Link (Optional)</label>
                    <input type="url" id="whatsappLink" placeholder="https://chat.whatsapp.com/...">
                </div>
                
                <div class="form-group">
                    <label for="sessionDuration">Session Duration</label>
                    <select id="sessionDuration" required>
                        <option value="5">5 Minutes</option>
                        <option value="15">15 Minutes</option>
                        <option value="30">30 Minutes</option>
                        <option value="60">1 Hour</option>
                        <option value="180">3 Hours</option>
                        <option value="1440">1 Day</option>
                        <option value="4320">3 Days</option>
                    </select>
                </div>
                
                <button type="submit" class="btn" id="createSessionBtn">Create Session</button>
            </form>
        </div>
        
        <!-- Session Result -->
        <div id="sessionResult" style="display: none;">
            <h1>Session Created</h1>
            <p>Share this link with participants to collect their contact details:</p>
            
            <div class="session-link">
                <span id="sessionLink"></span>
                <button class="copy-btn" id="copyLinkBtn">Copy</button>
            </div>
            
            <div class="loader" id="sessionLoader"></div>
            <div class="message" id="sessionMessage"></div>
        </div>

        <!-- Contact Form (shown when joining a session) -->
        <div id="contactFormSection" style="display: none;">
            <h1 id="sessionTitle"></h1>
            <div class="countdown" id="countdown"></div>
            
            <div id="whatsappContainer" style="display: none;">
                <a href="#" class="btn-whatsapp" id="whatsappLinkBtn" target="_blank">
                    Join WhatsApp Group for file
                </a>
            </div>
            
            <div class="message" id="notification"></div>
            
            <form id="contactForm">
                <div class="form-group">
                    <label for="fullName">Full Name</label>
                    <input type="text" id="fullName" required placeholder="John Doe">
                </div>
                
                <div class="form-group">
                    <label for="phoneNumber">Phone Number</label>
                    <div class="input-group">
                        <select id="countryCode" required>
                            <option value="+234">+234 (NG)</option>
                            <option value="+233">+233 (GH)</option>
                            <option value="+254">+254 (KE)</option>
                            <option value="+27">+27 (ZA)</option>
                            <option value="+1">+1 (US)</option>
                            <option value="+44">+44 (UK)</option>
                            <option value="+91">+91 (IN)</option>
                            <option value="+86">+86 (CN)</option>
                        </select>
                        <input type="number" id="phoneNumber" required placeholder="8012345678">
                    </div>
                </div>
                
                <button type="submit" class="btn" id="addContactBtn">Add Contact</button>
            </form>
            
            <div class="member-count">
                Total Members: <span id="memberCount">0</span>
            </div>
        </div>

        <!-- Download Section (shown when session has ended) -->
        <div id="downloadSection" style="display: none;">
            <h1>Session Ended</h1>
            <p>The contact collection session has ended. You can now download the VCF file containing all contacts.</p>
            <button class="btn" id="downloadBtn">Download VCF File</button>
        </div>
        
        <div class="powered-by">
            Powered by The.Zane.Nelson
        </div>
    </div>

    <script>
        // DOM Elements
        const initialView = document.getElementById('initialView');
        const startBtn = document.getElementById('startBtn');
        const sessionSetup = document.getElementById('sessionSetup');
        const sessionForm = document.getElementById('sessionForm');
        const sessionResult = document.getElementById('sessionResult');
        const sessionLink = document.getElementById('sessionLink');
        const sessionLoader = document.getElementById('sessionLoader');
        const sessionMessage = document.getElementById('sessionMessage');
        const contactFormSection = document.getElementById('contactFormSection');
        const downloadSection = document.getElementById('downloadSection');
        const sessionTitle = document.getElementById('sessionTitle');
        const countdown = document.getElementById('countdown');
        const whatsappContainer = document.getElementById('whatsappContainer');
        const whatsappLinkBtn = document.getElementById('whatsappLinkBtn');
        const notification = document.getElementById('notification');
        const contactForm = document.getElementById('contactForm');
        const memberCount = document.getElementById('memberCount');
        const downloadBtn = document.getElementById('downloadBtn');
        const createSessionBtn = document.getElementById('createSessionBtn');
        const addContactBtn = document.getElementById('addContactBtn');
        const copyLinkBtn = document.getElementById('copyLinkBtn');

        // Current session data
        let currentSession = null;
        let contacts = [];
        let timerInterval = null;

        // Initialize the app
        function initApp() {
            // Check if there's a session in the URL
            const urlParams = new URLSearchParams(window.location.search);
            const sessionId = urlParams.get('session');
            
            if (sessionId) {
                // Load the session
                loadSession(sessionId);
            } else {
                // Check if we're managing a session
                const savedSession = localStorage.getItem('currentSession');
                if (savedSession) {
                    currentSession = JSON.parse(savedSession);
                    // showSessionResult();
                    initialView.style.display = 'block';
                }
            }
            
            // Set up event listeners
            setupEventListeners();
        }

        // Set up event listeners
        function setupEventListeners() {
            // Start button
            startBtn.addEventListener('click', function() {
                initialView.style.display = 'none';
                sessionSetup.style.display = 'block';
            });
            
            // Session form submission
            sessionForm.addEventListener('submit', function(e) {
                e.preventDefault();
                if (validateSessionForm()) {
                    createSession();
                }
            });
            
            // Contact form submission
            contactForm.addEventListener('submit', function(e) {
                e.preventDefault();
                if (validateContactForm()) {
                    addContact();
                }
            });
            
            // Download button
            downloadBtn.addEventListener('click', downloadVcf);
            
            // Copy link button
            copyLinkBtn.addEventListener('click', copySessionLink);
        }

        // Validate session form
        function validateSessionForm() {
            const sessionName = document.getElementById('sessionName').value;
            const sessionDuration = document.getElementById('sessionDuration').value;
            
            if (!sessionName.trim()) {
                showMessage('Please enter a session name', 'error', sessionMessage);
                return false;
            }
            
            if (!sessionDuration) {
                showMessage('Please select a session duration', 'error', sessionMessage);
                return false;
            }
            
            return true;
        }

        // Validate contact form
        function validateContactForm() {
            const fullName = document.getElementById('fullName').value;
            const phoneNumber = document.getElementById('phoneNumber').value;
            
            if (!fullName.trim()) {
                showNotification('Please enter your full name', 'error');
                return false;
            }
            
            if (!phoneNumber.trim()) {
                showNotification('Please enter your phone number', 'error');
                return false;
            }
            
            return true;
        }

        // Create a new session
        function createSession() {
            showLoading(sessionLoader);
            
            const sessionName = document.getElementById('sessionName').value;
            const contactPrefix = document.getElementById('contactPrefix').value || '';
            const whatsappLink = document.getElementById('whatsappLink').value;
            const duration = parseInt(document.getElementById('sessionDuration').value);
            
            // Generate a unique session ID
            const sessionId = generateId();
            
            currentSession = {
                id: sessionId,
                name: sessionName,
                prefix: contactPrefix,
                whatsapp: whatsappLink,
                duration: duration,
                createdAt: Date.now(),
                endTime: Date.now() + (duration * 60000),
                contacts: []
            };
            
            // Save to localStorage
            localStorage.setItem('currentSession', JSON.stringify(currentSession));
            localStorage.setItem(`session_${sessionId}`, JSON.stringify(currentSession));
            
            // Generate the session link
            const link = `${window.location.origin}${window.location.pathname}?session=${sessionId}`;
            sessionLink.textContent = link;
            
            // Show the result section
            sessionSetup.style.display = 'none';
            sessionResult.style.display = 'block';
            
            hideLoading(sessionLoader);
            showMessage('Session created successfully!', 'success', sessionMessage);
        }

        // Load a session
        function loadSession(sessionId) {
            showLoading();
            
            // Try to load from localStorage
            const savedSession = localStorage.getItem(`session_${sessionId}`);
            
            if (savedSession) {
                currentSession = JSON.parse(savedSession);
                
                // Check if session has ended
                if (Date.now() > currentSession.endTime) {
                    showDownloadSection();
                } else {
                    showContactForm();
                    startTimer();
                }
            } else {
                // Session not found
                showMessage('Session not found or has expired', 'error', notification);
                setTimeout(() => {
                    window.location.href = window.location.origin + window.location.pathname;
                }, 2000);
            }
            
            hideLoading();
        }

        // Show session result
        function showSessionResult() {
            initialView.style.display = 'none';
            sessionSetup.style.display = 'none';
            sessionResult.style.display = 'block';
            
            // Generate the session link
            const link = `${window.location.origin}${window.location.pathname}?session=${currentSession.id}`;
            sessionLink.textContent = link;
        }

        // Show contact form
        function showContactForm() {
            initialView.style.display = 'none';
            sessionSetup.style.display = 'none';
            sessionResult.style.display = 'none';
            contactFormSection.style.display = 'block';
            
            // Set session title
            sessionTitle.textContent = currentSession.name;
            
            // Show WhatsApp link if available
            if (currentSession.whatsapp) {
                whatsappContainer.style.display = 'block';
                whatsappLinkBtn.href = currentSession.whatsapp;
            }
            
            // Update member count
            updateMemberCount();
        }

        // Show download section
        function showDownloadSection() {
            initialView.style.display = 'none';
            sessionSetup.style.display = 'none';
            sessionResult.style.display = 'none';
            contactFormSection.style.display = 'none';
            downloadSection.style.display = 'block';
            
            // Load contacts
            contacts = currentSession.contacts || [];
        }

        // Start countdown timer
        function startTimer() {
            updateTimer();
            timerInterval = setInterval(updateTimer, 1000);
        }

        // Update timer display
        function updateTimer() {
            const now = Date.now();
            const remaining = currentSession.endTime - now;
            
            if (remaining <= 0) {
                clearInterval(timerInterval);
                countdown.textContent = "Session ended";
                showDownloadSection();
                return;
            }
            
            const hours = Math.floor(remaining / (1000 * 60 * 60));
            const minutes = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((remaining % (1000 * 60)) / 1000);
            
            countdown.textContent = `${hours}h ${minutes}m ${seconds}s remaining`;
        }

        // Add a contact
        function addContact() {
            const fullName = currentSession.prefix + document.getElementById('fullName').value.trim();
            const countryCode = document.getElementById('countryCode').value;
            const phoneNumber = document.getElementById('phoneNumber').value.trim();
            
            // Validate phone number
            if (!phoneNumber) {
                showNotification('Please enter a phone number', 'error');
                return;
            }
            
            // Check if contact already exists
            const phone = countryCode + phoneNumber;
            if (currentSession.contacts.some(c => c.phone === phone)) {
                showNotification('This contact already exists', 'error');
                return;
            }
            
            // Add contact
            const contact = {
                fullName,
                phone,
                addedAt: Date.now()
            };
            
            currentSession.contacts.push(contact);
            
            // Update session in storage
            localStorage.setItem(`session_${currentSession.id}`, JSON.stringify(currentSession));
            
            // Show success
            showNotification('Contact added successfully', 'success');
            
            // Clear form
            document.getElementById('fullName').value = '';
            document.getElementById('phoneNumber').value = '';
            
            // Update member count
            updateMemberCount();
        }

        // Update member count display
        function updateMemberCount() {
            memberCount.textContent = currentSession.contacts.length;
        }

        // Download VCF file
        function downloadVcf() {
            showLoading();
            
            let vcfContent = '';
            
            contacts.forEach(contact => {
                vcfContent += `BEGIN:VCARD\n`;
                vcfContent += `VERSION:3.0\n`;
                vcfContent += `FN:${contact.fullName}\n`;
                vcfContent += `TEL;TYPE=CELL:${contact.phone}\n`;
                vcfContent += `END:VCARD\n`;
            });
            
            // Create a blob and download it
            const blob = new Blob([vcfContent], { type: 'text/vcard' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `${currentSession.name.replace(/[^a-z0-9]/gi, '_')}_contacts.vcf`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            hideLoading();
        }

        // Show notification
        function showNotification(message, type) {
            notification.textContent = message;
            notification.className = 'message ' + type;
            notification.style.display = 'block';
            
            // Hide after 3 seconds
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }
        
        // Show message
        function showMessage(message, type, element) {
            element.textContent = message;
            element.className = 'message ' + type;
            element.style.display = 'block';
        }

        // Copy session link to clipboard
        function copySessionLink() {
            const link = sessionLink.textContent;
            navigator.clipboard.writeText(link).then(() => {
                showMessage('Link copied to clipboard!', 'success', sessionMessage);
            });
        }

        // Generate a random ID
        function generateId() {
            return Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
        }

        // Show loading
        function showLoading(loaderElement = null) {
            if (loaderElement) {
                loaderElement.style.display = 'block';
            }
        }

        // Hide loading
        function hideLoading(loaderElement = null) {
            if (loaderElement) {
                loaderElement.style.display = 'none';
            }
        }

        // Initialize the app when the DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>